

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ETL package &mdash; EstacionMeteorologica 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Config package" href="config.html" />
    <link rel="prev" title="Módulos" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            EstacionMeteorologica
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenido:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Módulos</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ETL package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-etl.extractors.data_extractor">Extractores (Lectura de datos)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etl.extractors.data_extractor.DataExtractor"><code class="docutils literal notranslate"><span class="pre">DataExtractor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etl.extractors.table_inspector.TableInspector"><code class="docutils literal notranslate"><span class="pre">TableInspector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etl.extractors.table_inspector.TrackingColumnDetector"><code class="docutils literal notranslate"><span class="pre">TrackingColumnDetector</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etl.writers.file_writer">Escritores (Serialización)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etl.writers.file_writer.FileWriter"><code class="docutils literal notranslate"><span class="pre">FileWriter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etl.writers.csv_writer.CSVWriter"><code class="docutils literal notranslate"><span class="pre">CSVWriter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etl.uploaders.minio_uploader">Cargadores (Almacenamiento)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etl.uploaders.minio_uploader.MinIOUploader"><code class="docutils literal notranslate"><span class="pre">MinIOUploader</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etl.control.control_manager">Control (Gestión de estado)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etl.control.control_manager.ETLControlManager"><code class="docutils literal notranslate"><span class="pre">ETLControlManager</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etl.managers.silver_manager">Managers (Procesos de negocio)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etl.managers.silver_manager.SilverManager"><code class="docutils literal notranslate"><span class="pre">SilverManager</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etl-managers-limpieza-bronce">etl.managers.limpieza_bronce</a></li>
<li class="toctree-l4"><a class="reference internal" href="#etl.managers.limpieza_bronce.LimpiezaBronce"><code class="docutils literal notranslate"><span class="pre">LimpiezaBronce</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etl.utils.db_utils">Utilidades (BD y queries)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etl.utils.db_utils.DatabaseUtils"><code class="docutils literal notranslate"><span class="pre">DatabaseUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etl.utils.db_utils.ETLControlQueries"><code class="docutils literal notranslate"><span class="pre">ETLControlQueries</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etl.utils.db_utils.TableQueryBuilder"><code class="docutils literal notranslate"><span class="pre">TableQueryBuilder</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etl.pipeline">Orquestación (Pipeline)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etl.pipeline.ETLPipeline"><code class="docutils literal notranslate"><span class="pre">ETLPipeline</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etl.table_processor.TableProcessor"><code class="docutils literal notranslate"><span class="pre">TableProcessor</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Config package</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EstacionMeteorologica</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Módulos</a></li>
      <li class="breadcrumb-item active">ETL package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/etl.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="etl-package">
<h1>ETL package<a class="headerlink" href="#etl-package" title="Link to this heading"></a></h1>
<p>Documentación de los módulos principales bajo <cite>etl</cite>.</p>
<section id="module-etl.extractors.data_extractor">
<span id="extractores-lectura-de-datos"></span><h2>Extractores (Lectura de datos)<a class="headerlink" href="#module-etl.extractors.data_extractor" title="Link to this heading"></a></h2>
<p>Extracción incremental de datos desde PostgreSQL.</p>
<p>Este módulo contiene la clase <a class="reference internal" href="#etl.extractors.data_extractor.DataExtractor" title="etl.extractors.data_extractor.DataExtractor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataExtractor</span></code></a> que encapsula la lógica
para construir la consulta de extracción incremental (o carga inicial)
y ejecutar la consulta devolviendo un <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.extractors.data_extractor.DataExtractor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.extractors.data_extractor.</span></span><span class="sig-name descname"><span class="pre">DataExtractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracking_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracking_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/extractors/data_extractor.html#DataExtractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.data_extractor.DataExtractor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Extrae datos incrementales de PostgreSQL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>)</p></li>
<li><p><strong>table_name</strong> (<em>str</em>)</p></li>
<li><p><strong>tracking_column</strong> (<em>str</em>)</p></li>
<li><p><strong>tracking_type</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="etl.extractors.data_extractor.DataExtractor.extract_incremental">
<span class="sig-name descname"><span class="pre">extract_incremental</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.DataFrame</span></span></span><a class="reference internal" href="_modules/etl/extractors/data_extractor.html#DataExtractor.extract_incremental"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.data_extractor.DataExtractor.extract_incremental" title="Link to this definition"></a></dt>
<dd><p>Extrae datos nuevos desde el último valor procesado.</p>
<p>Construye la consulta SQL adecuada. Si <code class="docutils literal notranslate"><span class="pre">last_value</span></code> es proporcionado
se extraen únicamente filas con <code class="docutils literal notranslate"><span class="pre">tracking_column</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">last_value</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>last_value</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – Último valor procesado (None para carga inicial).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame con los registros extraídos (posible vacío).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p>Ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">etl.extractors.data_extractor</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataExtractor</span>
<span class="n">extractor</span> <span class="o">=</span> <span class="n">DataExtractor</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s1">&#39;sensor_readings&#39;</span><span class="p">,</span> <span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>
<span class="c1"># Carga inicial</span>
<span class="n">df_all</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">extract_incremental</span><span class="p">()</span>
<span class="c1"># Extracción incremental</span>
<span class="n">last</span> <span class="o">=</span> <span class="n">df_all</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">df_new</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">extract_incremental</span><span class="p">(</span><span class="n">last_value</span><span class="o">=</span><span class="n">last</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Notas:</dt><dd><ul class="simple">
<li><p>Devuelve un DataFrame compatible con pandas, por lo que el resto del
pipeline puede operar con métodos estándar como <code class="docutils literal notranslate"><span class="pre">to_csv</span></code> o <code class="docutils literal notranslate"><span class="pre">concat</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_value</span></code> puede ser string ISO (para timestamps) o numérico (para ids),
el método intenta formatearlo correctamente en la consulta.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-etl.extractors.table_inspector">Inspección de estructuras de tablas en PostgreSQL.</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.extractors.table_inspector.TableInspector">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.extractors.table_inspector.</span></span><span class="sig-name descname"><span class="pre">TableInspector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/extractors/table_inspector.html#TableInspector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.table_inspector.TableInspector" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Inspecciona estructura de tablas PostgreSQL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="etl.extractors.table_inspector.TableInspector.detect_tracking_column">
<span class="sig-name descname"><span class="pre">detect_tracking_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/extractors/table_inspector.html#TableInspector.detect_tracking_column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.table_inspector.TableInspector.detect_tracking_column" title="Link to this definition"></a></dt>
<dd><p>Detecta mejor columna para rastreo.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(column_name, column_type) o (None, None)</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>table_name</strong> (<em>str</em>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[str | None, str | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.extractors.table_inspector.TableInspector.get_all_tables">
<span class="sig-name descname"><span class="pre">get_all_tables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/extractors/table_inspector.html#TableInspector.get_all_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.table_inspector.TableInspector.get_all_tables" title="Link to this definition"></a></dt>
<dd><p>Obtiene lista de todas las tablas.</p>
<p>Excluye tabla ‘etl_control’.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Lista de nombres de tablas</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.extractors.table_inspector.TableInspector.get_columns">
<span class="sig-name descname"><span class="pre">get_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/extractors/table_inspector.html#TableInspector.get_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.table_inspector.TableInspector.get_columns" title="Link to this definition"></a></dt>
<dd><p>Obtiene columnas con tipos de datos.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table_name</strong> (<em>str</em>) – Nombre de la tabla</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lista de (column_name, data_type)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[str, str]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="etl.extractors.table_inspector.TrackingColumnDetector">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.extractors.table_inspector.</span></span><span class="sig-name descname"><span class="pre">TrackingColumnDetector</span></span><a class="reference internal" href="_modules/etl/extractors/table_inspector.html#TrackingColumnDetector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.table_inspector.TrackingColumnDetector" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Detecta automáticamente la mejor columna para rastreo.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="etl.extractors.table_inspector.TrackingColumnDetector.TIMESTAMP_CANDIDATES">
<span class="sig-name descname"><span class="pre">TIMESTAMP_CANDIDATES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['created_at',</span> <span class="pre">'updated_at',</span> <span class="pre">'timestamp',</span> <span class="pre">'fecha_registro',</span> <span class="pre">'last_update']</span></em><a class="headerlink" href="#etl.extractors.table_inspector.TrackingColumnDetector.TIMESTAMP_CANDIDATES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.extractors.table_inspector.TrackingColumnDetector.detect">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/extractors/table_inspector.html#TrackingColumnDetector.detect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.table_inspector.TrackingColumnDetector.detect" title="Link to this definition"></a></dt>
<dd><p>Detecta mejor columna para rastreo.</p>
<p>Prioridades:
1. Timestamp (created_at, updated_at, etc.)
2. PRIMARY KEY numérico
3. Columna ‘id’ numérica</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(column_name, column_type) o None</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>columns</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>)</p></li>
<li><p><strong>table_name</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[str, str] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.extractors.table_inspector.TrackingColumnDetector.is_numeric_type">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_numeric_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/etl/extractors/table_inspector.html#TrackingColumnDetector.is_numeric_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.table_inspector.TrackingColumnDetector.is_numeric_type" title="Link to this definition"></a></dt>
<dd><p>Verifica si tipo es numérico.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col_type</strong> (<em>str</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.extractors.table_inspector.TrackingColumnDetector.is_timestamp_type">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_timestamp_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/etl/extractors/table_inspector.html#TrackingColumnDetector.is_timestamp_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.extractors.table_inspector.TrackingColumnDetector.is_timestamp_type" title="Link to this definition"></a></dt>
<dd><p>Verifica si tipo es timestamp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col_type</strong> (<em>str</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-etl.writers.file_writer">
<span id="escritores-serializacion"></span><h2>Escritores (Serialización)<a class="headerlink" href="#module-etl.writers.file_writer" title="Link to this heading"></a></h2>
<p>Clase base para escritores de archivos.</p>
<p>Proporciona la interfaz abstracta para serializar DataFrames a disco.</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.writers.file_writer.FileWriter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.writers.file_writer.</span></span><span class="sig-name descname"><span class="pre">FileWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/writers/file_writer.html#FileWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.writers.file_writer.FileWriter" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Clase base para escritores de archivos.</p>
<p>Proporciona la lógica común de nombre de fichero temporal y eliminación
del archivo cuando ya no es necesario.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<em>str</em>)</p></li>
<li><p><strong>extension</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="etl.writers.file_writer.FileWriter.cleanup">
<span class="sig-name descname"><span class="pre">cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/writers/file_writer.html#FileWriter.cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.writers.file_writer.FileWriter.cleanup" title="Link to this definition"></a></dt>
<dd><p>Elimina archivo temporal.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.writers.file_writer.FileWriter.write">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/etl/writers/file_writer.html#FileWriter.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.writers.file_writer.FileWriter.write" title="Link to this definition"></a></dt>
<dd><p>Escribe DataFrame a archivo.</p>
<p>Debe ser implementado por subclases y retornar la ruta local del
archivo generado.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – DataFrame a serializar.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ruta absoluta al archivo generado.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>Ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">writer</span> <span class="o">=</span> <span class="n">CSVWriter</span><span class="p">(</span><span class="s1">&#39;sensor_readings&#39;</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="c1"># path -&gt; &#39;C:\Windows\Temp\sensor_readings_bronce_20250101120000.csv&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<p id="module-etl.writers.csv_writer">Escritor de archivos CSV.</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.writers.csv_writer.CSVWriter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.writers.csv_writer.</span></span><span class="sig-name descname"><span class="pre">CSVWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/writers/csv_writer.html#CSVWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.writers.csv_writer.CSVWriter" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#etl.writers.file_writer.FileWriter" title="etl.writers.file_writer.FileWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileWriter</span></code></a></p>
<p>Escritor de archivos CSV.</p>
<p>Serializa DataFrames a archivos CSV en la carpeta temporal del sistema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table_name</strong> (<em>str</em>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="etl.writers.csv_writer.CSVWriter.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/etl/writers/csv_writer.html#CSVWriter.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.writers.csv_writer.CSVWriter.write" title="Link to this definition"></a></dt>
<dd><p>Guarda DataFrame como CSV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – DataFrame a serializar.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ruta absoluta al archivo generado.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-etl.uploaders.minio_uploader">
<span id="cargadores-almacenamiento"></span><h2>Cargadores (Almacenamiento)<a class="headerlink" href="#module-etl.uploaders.minio_uploader" title="Link to this heading"></a></h2>
<p>Gestión de subida de archivos a MinIO.</p>
<p>Proporciona una pequeña envoltura sobre la librería <code class="docutils literal notranslate"><span class="pre">minio</span></code> para
subir archivos locales al bucket configurado en <code class="docutils literal notranslate"><span class="pre">MinIOConfig</span></code>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.uploaders.minio_uploader.MinIOUploader">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.uploaders.minio_uploader.</span></span><span class="sig-name descname"><span class="pre">MinIOUploader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minio_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="config.html#config.minio_config.MinIOConfig" title="config.minio_config.MinIOConfig"><span class="pre">MinIOConfig</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/uploaders/minio_uploader.html#MinIOUploader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.uploaders.minio_uploader.MinIOUploader" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gestiona subida de archivos a MinIO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minio_config</strong> (<a class="reference internal" href="config.html#config.minio_config.MinIOConfig" title="config.minio_config.MinIOConfig"><em>config.minio_config.MinIOConfig</em></a>) – Instancia de configuración de MinIO.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="etl.uploaders.minio_uploader.MinIOUploader.upload">
<span class="sig-name descname"><span class="pre">upload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/etl/uploaders/minio_uploader.html#MinIOUploader.upload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.uploaders.minio_uploader.MinIOUploader.upload" title="Link to this definition"></a></dt>
<dd><p>Sube archivo a MinIO y retorna la ruta en el bucket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>local_path</strong> (<em>str</em>) – Ruta local del archivo.</p></li>
<li><p><strong>table_name</strong> (<em>str</em>) – Nombre lógico de la tabla (se usa como prefijo).</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – Nombre del archivo objetivo.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ruta completa en MinIO: <code class="docutils literal notranslate"><span class="pre">{bucket}/{table_name}/{file_name}</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>Ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uploader</span> <span class="o">=</span> <span class="n">MinIOUploader</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">uri</span> <span class="o">=</span> <span class="n">uploader</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="s1">&#39;C:/tmp/sensor.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;sensor_readings&#39;</span><span class="p">,</span> <span class="s1">&#39;sensor_bronce_20250101.csv&#39;</span><span class="p">)</span>
<span class="c1"># uri -&gt; &#39;meteo-bronze/sensor_readings/sensor_bronce_20250101.csv&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-etl.control.control_manager">
<span id="control-gestion-de-estado"></span><h2>Control (Gestión de estado)<a class="headerlink" href="#module-etl.control.control_manager" title="Link to this heading"></a></h2>
<p>Gestión de tabla de control para rastreo de extracciones.</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.control.control_manager.ETLControlManager">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.control.control_manager.</span></span><span class="sig-name descname"><span class="pre">ETLControlManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/control/control_manager.html#ETLControlManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.control.control_manager.ETLControlManager" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gestiona tabla de control para rastreo de extracciones incrementales.</p>
<p>La tabla <code class="docutils literal notranslate"><span class="pre">etl_control</span></code> almacena el último valor extraído de cada tabla,
permitiendo reiniciar extracciones desde el último punto procesado.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="etl.control.control_manager.ETLControlManager.get_last_extracted_value">
<span class="sig-name descname"><span class="pre">get_last_extracted_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/control/control_manager.html#ETLControlManager.get_last_extracted_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.control.control_manager.ETLControlManager.get_last_extracted_value" title="Link to this definition"></a></dt>
<dd><p>Obtiene último valor extraído.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table_name</strong> (<em>str</em>) – Nombre de la tabla.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tupla <code class="docutils literal notranslate"><span class="pre">(last_value,</span> <span class="pre">tracking_column)</span></code>
o <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code> si no existe registro.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Optional[str], Optional[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.control.control_manager.ETLControlManager.initialize_table">
<span class="sig-name descname"><span class="pre">initialize_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/control/control_manager.html#ETLControlManager.initialize_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.control.control_manager.ETLControlManager.initialize_table" title="Link to this definition"></a></dt>
<dd><p>Crea tabla <code class="docutils literal notranslate"><span class="pre">etl_control</span></code> si no existe.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.control.control_manager.ETLControlManager.update_last_extracted_value">
<span class="sig-name descname"><span class="pre">update_last_extracted_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracking_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/control/control_manager.html#ETLControlManager.update_last_extracted_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.control.control_manager.ETLControlManager.update_last_extracted_value" title="Link to this definition"></a></dt>
<dd><p>Actualiza último valor extraído (UPSERT).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<em>str</em>) – Nombre de la tabla.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – Nuevo valor máximo extraído (numérico o timestamp).</p></li>
<li><p><strong>tracking_column</strong> (<em>str</em>) – Nombre de columna de rastreo.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-etl.managers.silver_manager">
<span id="managers-procesos-de-negocio"></span><h2>Managers (Procesos de negocio)<a class="headerlink" href="#module-etl.managers.silver_manager" title="Link to this heading"></a></h2>
<p>Gestor de la capa Silver y gestión de versiones.</p>
<p>Este módulo implementa una estrategia simple de versiones (REPLACE) donde
solo se mantiene la versión más reciente de cada tabla en el bucket Silver.</p>
<p>Funciones principales:
- listar versiones por tabla
- obtener la versión más reciente
- eliminar versiones antiguas
- obtener estadísticas (tamaño total, número de versiones)</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.managers.silver_manager.SilverManager">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.managers.silver_manager.</span></span><span class="sig-name descname"><span class="pre">SilverManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minio_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/managers/silver_manager.html#SilverManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.silver_manager.SilverManager" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gestiona archivos en capa Silver - Limpia versiones antiguas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minio_config</strong> – Instancia de configuración de MinIO con atributos
<code class="docutils literal notranslate"><span class="pre">endpoint</span></code>, <code class="docutils literal notranslate"><span class="pre">access_key</span></code>, <code class="docutils literal notranslate"><span class="pre">secret_key</span></code> y <code class="docutils literal notranslate"><span class="pre">bucket</span></code>.</p>
</dd>
</dl>
<p>Ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">config</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinIOConfig</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">MinIOConfig</span><span class="p">()</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">SilverManager</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">sm</span><span class="o">.</span><span class="n">limpiar_versiones_antiguas</span><span class="p">(</span><span class="s1">&#39;sensor_readings&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.silver_manager.SilverManager.eliminar_archivo">
<span class="sig-name descname"><span class="pre">eliminar_archivo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabla</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">archivo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/etl/managers/silver_manager.html#SilverManager.eliminar_archivo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.silver_manager.SilverManager.eliminar_archivo" title="Link to this definition"></a></dt>
<dd><p>Elimina un archivo específico de Silver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabla</strong> (<em>str</em>) – Nombre de la tabla.</p></li>
<li><p><strong>archivo</strong> (<em>str</em>) – Nombre del archivo a eliminar.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True si se eliminó correctamente.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.silver_manager.SilverManager.limpiar_versiones_antiguas">
<span class="sig-name descname"><span class="pre">limpiar_versiones_antiguas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabla</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mantener_actual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/etl/managers/silver_manager.html#SilverManager.limpiar_versiones_antiguas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.silver_manager.SilverManager.limpiar_versiones_antiguas" title="Link to this definition"></a></dt>
<dd><p>Elimina archivos Silver antiguos según la estrategia REPLACE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabla</strong> (<em>str</em>) – Nombre de la tabla (p. ej. <code class="docutils literal notranslate"><span class="pre">sensor_readings</span></code>).</p></li>
<li><p><strong>mantener_actual</strong> (<em>bool</em>) – Si <code class="docutils literal notranslate"><span class="pre">True</span></code> mantiene solo la versión más reciente;
si <code class="docutils literal notranslate"><span class="pre">False</span></code> elimina todas las versiones.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cantidad de archivos eliminados.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p>Ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span> <span class="o">=</span> <span class="n">SilverManager</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">removed</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">limpiar_versiones_antiguas</span><span class="p">(</span><span class="s1">&#39;sensor_readings&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Archivos eliminados: </span><span class="si">{</span><span class="n">removed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.silver_manager.SilverManager.obtener_archivo_reciente">
<span class="sig-name descname"><span class="pre">obtener_archivo_reciente</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabla</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/managers/silver_manager.html#SilverManager.obtener_archivo_reciente"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.silver_manager.SilverManager.obtener_archivo_reciente" title="Link to this definition"></a></dt>
<dd><p>Obtiene el archivo Silver más reciente de una tabla.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tabla</strong> (<em>str</em>) – Nombre de la tabla.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nombre del archivo más reciente o None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.silver_manager.SilverManager.obtener_estadisticas_tabla">
<span class="sig-name descname"><span class="pre">obtener_estadisticas_tabla</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabla</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/managers/silver_manager.html#SilverManager.obtener_estadisticas_tabla"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.silver_manager.SilverManager.obtener_estadisticas_tabla" title="Link to this definition"></a></dt>
<dd><p>Obtiene estadísticas de versiones de una tabla.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tabla</strong> (<em>str</em>) – Nombre de la tabla.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Diccionario con estadísticas (tabla, total_versiones, versión_antigua,
versión_reciente, espacio_total_mb).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.silver_manager.SilverManager.obtener_versiones_tabla">
<span class="sig-name descname"><span class="pre">obtener_versiones_tabla</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabla</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/managers/silver_manager.html#SilverManager.obtener_versiones_tabla"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.silver_manager.SilverManager.obtener_versiones_tabla" title="Link to this definition"></a></dt>
<dd><p>Obtiene TODOS los archivos Silver de una tabla, ordenados por fecha.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tabla</strong> (<em>str</em>) – Nombre de la tabla (ej: <code class="docutils literal notranslate"><span class="pre">sensor_readings</span></code>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lista de nombres de archivos ordenados (antiguos → recientes).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="etl-managers-limpieza-bronce">
<span id="module-etl.managers.limpieza_bronce"></span><h3>etl.managers.limpieza_bronce<a class="headerlink" href="#etl-managers-limpieza-bronce" title="Link to this heading"></a></h3>
<p>Herramientas para procesar los CSV almacenados en la capa <em>Bronce</em> y
publicar resultados limpios en la capa <em>Silver</em>.</p>
<p>Principales responsabilidades:
- Buscar todos los CSV de una tabla en el bucket Bronce
- Descargar y combinar múltiples extracciones
- Aplicar limpieza específica por tabla (ej: <cite>sensor_readings</cite>)
- Guardar el resultado en Silver utilizando estrategia REPLACE
- Invocar a <a class="reference internal" href="#etl.managers.silver_manager.SilverManager" title="etl.managers.silver_manager.SilverManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">etl.managers.silver_manager.SilverManager</span></code></a> para gestionar versiones</p>
<p>El módulo está diseñado para trabajar con MinIO (S3 compatible) y pandas
para la fase de limpieza. Las funciones devuelven rutas temporales o
estructuras Python simples (dict) pensadas para registro/telemetría.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="etl.managers.limpieza_bronce.LimpiezaBronce">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.managers.limpieza_bronce.</span></span><span class="sig-name descname"><span class="pre">LimpiezaBronce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minio_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/managers/limpieza_bronce.html#LimpiezaBronce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.limpieza_bronce.LimpiezaBronce" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Limpia datos de la capa Bronce y los guarda en Silver.</p>
<p>Uso básico:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">config</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinIOConfig</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">etl.managers.limpieza_bronce</span><span class="w"> </span><span class="kn">import</span> <span class="n">LimpiezaBronce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">MinIOConfig</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cleaner</span> <span class="o">=</span> <span class="n">LimpiezaBronce</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resultado</span> <span class="o">=</span> <span class="n">cleaner</span><span class="o">.</span><span class="n">procesar_tabla</span><span class="p">(</span><span class="s1">&#39;sensor_readings&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Métodos principales
- <a class="reference internal" href="#etl.managers.limpieza_bronce.LimpiezaBronce.obtener_archivos_tabla" title="etl.managers.limpieza_bronce.LimpiezaBronce.obtener_archivos_tabla"><code class="xref py py-meth docutils literal notranslate"><span class="pre">obtener_archivos_tabla()</span></code></a> : lista objetos Bronce
- <a class="reference internal" href="#etl.managers.limpieza_bronce.LimpiezaBronce.combinar_csvs" title="etl.managers.limpieza_bronce.LimpiezaBronce.combinar_csvs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">combinar_csvs()</span></code></a> : concatena múltiples CSV en un DataFrame
- <a class="reference internal" href="#etl.managers.limpieza_bronce.LimpiezaBronce.limpiar_sensor_readings" title="etl.managers.limpieza_bronce.LimpiezaBronce.limpiar_sensor_readings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">limpiar_sensor_readings()</span></code></a> : lógica de limpieza por tabla
- <a class="reference internal" href="#etl.managers.limpieza_bronce.LimpiezaBronce.guardar_csv_como_parquet" title="etl.managers.limpieza_bronce.LimpiezaBronce.guardar_csv_como_parquet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">guardar_csv_como_parquet()</span></code></a> : guarda y sube el CSV limpio
- <a class="reference internal" href="#etl.managers.limpieza_bronce.LimpiezaBronce.procesar_tabla" title="etl.managers.limpieza_bronce.LimpiezaBronce.procesar_tabla"><code class="xref py py-meth docutils literal notranslate"><span class="pre">procesar_tabla()</span></code></a> : flujo completo (lista → combinar → limpiar → guardar)</p>
<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.limpieza_bronce.LimpiezaBronce.combinar_csvs">
<span class="sig-name descname"><span class="pre">combinar_csvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">archivos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/managers/limpieza_bronce.html#LimpiezaBronce.combinar_csvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.limpieza_bronce.LimpiezaBronce.combinar_csvs" title="Link to this definition"></a></dt>
<dd><p>Combina múltiples CSVs (lista de objetos en MinIO) en un único pandas.DataFrame.</p>
<p>El método descarga cada CSV a un fichero temporal, lo lee con
<code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code> y concatena todos los frames respetando
el orden ascendente de archivos (se asume que el timestamp está
presente en el nombre del archivo).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>archivos</strong> (<em>list</em>) – Lista de nombres de objetos en MinIO (strings)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame combinado o <code class="docutils literal notranslate"><span class="pre">None</span></code> si no se encontraron datos.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.limpieza_bronce.LimpiezaBronce.descargar_csv">
<span class="sig-name descname"><span class="pre">descargar_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">archivo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/managers/limpieza_bronce.html#LimpiezaBronce.descargar_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.limpieza_bronce.LimpiezaBronce.descargar_csv" title="Link to this definition"></a></dt>
<dd><p>Descarga el CSV de MinIO a un fichero temporal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>archivo</strong> (<em>str</em>) – Ruta/objeto en el bucket (ej: ‘sensor_readings/<a href="#id1"><span class="problematic" id="id2">sensor_readings_bronce_</span></a>…csv’)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ruta absoluta al fichero temporal descargado, o <code class="docutils literal notranslate"><span class="pre">None</span></code> en caso de error.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.limpieza_bronce.LimpiezaBronce.guardar_csv_como_parquet">
<span class="sig-name descname"><span class="pre">guardar_csv_como_parquet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabla</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/managers/limpieza_bronce.html#LimpiezaBronce.guardar_csv_como_parquet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.limpieza_bronce.LimpiezaBronce.guardar_csv_como_parquet" title="Link to this definition"></a></dt>
<dd><p>Guarda el DataFrame como CSV en el bucket Silver.</p>
<p>Nombre generado: <code class="docutils literal notranslate"><span class="pre">{tabla}_silver_{YYYYmmddHHMMSS}.csv</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – DataFrame a guardar en Silver.</p></li>
<li><p><strong>tabla</strong> (<em>str</em>) – Nombre lógico de la tabla.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Nombre del archivo subido en Silver (p. ej. <code class="docutils literal notranslate"><span class="pre">sensor_readings_silver_20250101120000.csv</span></code>)</dt><dd><p>o <code class="docutils literal notranslate"><span class="pre">None</span></code> en caso de error.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.limpieza_bronce.LimpiezaBronce.limpiar_sensor_readings">
<span class="sig-name descname"><span class="pre">limpiar_sensor_readings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.DataFrame</span></span></span><a class="reference internal" href="_modules/etl/managers/limpieza_bronce.html#LimpiezaBronce.limpiar_sensor_readings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.limpieza_bronce.LimpiezaBronce.limpiar_sensor_readings" title="Link to this definition"></a></dt>
<dd><p>Aplica limpieza específica para la tabla <code class="docutils literal notranslate"><span class="pre">sensor_readings</span></code>.</p>
<p>Reglas implementadas:
- Eliminar duplicados exactos
- Reemplazar outliers en <code class="docutils literal notranslate"><span class="pre">temperature</span></code> por la mediana (IQR)
- Eliminar columnas irrelevantes
- Filtrar rangos válidos para <code class="docutils literal notranslate"><span class="pre">temperature</span></code> y <code class="docutils literal notranslate"><span class="pre">humidity</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – DataFrame original con columnas típicas de sensores
como <code class="docutils literal notranslate"><span class="pre">temperature</span></code>, <code class="docutils literal notranslate"><span class="pre">humidity</span></code>, etc.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame limpio.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p>Ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">etl.managers.limpieza_bronce</span><span class="w"> </span><span class="kn">import</span> <span class="n">LimpiezaBronce</span>
<span class="n">cleaner</span> <span class="o">=</span> <span class="n">LimpiezaBronce</span><span class="p">()</span>
<span class="n">df_clean</span> <span class="o">=</span> <span class="n">cleaner</span><span class="o">.</span><span class="n">limpiar_sensor_readings</span><span class="p">(</span><span class="n">df_raw</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Notas:</dt><dd><ul class="simple">
<li><p>Se asume que <code class="docutils literal notranslate"><span class="pre">temperature</span></code> y <code class="docutils literal notranslate"><span class="pre">humidity</span></code> están en unidades esperadas.</p></li>
<li><p>Los outliers en <code class="docutils literal notranslate"><span class="pre">temperature</span></code> se reemplazan por la mediana calculada
sobre los valores no nulos.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.limpieza_bronce.LimpiezaBronce.obtener_archivos_tabla">
<span class="sig-name descname"><span class="pre">obtener_archivos_tabla</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabla</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/managers/limpieza_bronce.html#LimpiezaBronce.obtener_archivos_tabla"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.limpieza_bronce.LimpiezaBronce.obtener_archivos_tabla" title="Link to this definition"></a></dt>
<dd><p>Obtiene TODOS los archivos CSV de una tabla (puede haber múltiples extracciones).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tabla</strong> (<em>str</em>) – Nombre de la tabla a procesar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lista de nombres de objetos en MinIO o None si hay error</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.managers.limpieza_bronce.LimpiezaBronce.procesar_tabla">
<span class="sig-name descname"><span class="pre">procesar_tabla</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabla</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/managers/limpieza_bronce.html#LimpiezaBronce.procesar_tabla"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.managers.limpieza_bronce.LimpiezaBronce.procesar_tabla" title="Link to this definition"></a></dt>
<dd><p>Procesa una tabla: obtiene CSVs de Bronce, limpia y guarda en Silver.
Estrategia REPLACE: Elimina versiones antiguas automáticamente.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tabla</strong> (<em>str</em>) – Nombre de la tabla a procesar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Diccionario con resultado del procesamiento o None si hay error</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict | None</p>
</dd>
</dl>
<p>Ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">etl.managers.limpieza_bronce</span><span class="w"> </span><span class="kn">import</span> <span class="n">LimpiezaBronce</span>
<span class="n">cleaner</span> <span class="o">=</span> <span class="n">LimpiezaBronce</span><span class="p">()</span>
<span class="n">resultado</span> <span class="o">=</span> <span class="n">cleaner</span><span class="o">.</span><span class="n">procesar_tabla</span><span class="p">(</span><span class="s1">&#39;sensor_readings&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">resultado</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Procesadas </span><span class="si">{</span><span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;filas_limpias&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> filas&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-etl.utils.db_utils">
<span id="utilidades-bd-y-queries"></span><h2>Utilidades (BD y queries)<a class="headerlink" href="#module-etl.utils.db_utils" title="Link to this heading"></a></h2>
<p>Utilidades para operaciones de base de datos y construcción de queries.</p>
<p>Contiene funciones reutilizables para ejecutar queries con SQLAlchemy y
construir consultas usadas por el pipeline (listar tablas, obtener columnas,
consulta incremental, etc.).</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.utils.db_utils.DatabaseUtils">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.utils.db_utils.</span></span><span class="sig-name descname"><span class="pre">DatabaseUtils</span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#DatabaseUtils"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.DatabaseUtils" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Métodos reutilizables para operaciones de BD.</p>
<p>Este wrapper ofrece manejo básico de errores y trazas para facilitar
el debugging durante la generación de documentación y la ejecución.</p>
<dl class="py method">
<dt class="sig sig-object py" id="etl.utils.db_utils.DatabaseUtils.execute_and_commit">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">execute_and_commit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#DatabaseUtils.execute_and_commit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.DatabaseUtils.execute_and_commit" title="Link to this definition"></a></dt>
<dd><p>Ejecuta query y hace commit. Retorna filas afectadas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>) – Conexión activa</p></li>
<li><p><strong>query</strong> (<em>str</em>) – Query SQL</p></li>
<li><p><strong>params</strong> (<em>dict</em><em> | </em><em>None</em>) – Parámetros</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cantidad de filas afectadas</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.utils.db_utils.DatabaseUtils.execute_query">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">execute_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#DatabaseUtils.execute_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.DatabaseUtils.execute_query" title="Link to this definition"></a></dt>
<dd><p>Ejecuta una query y retorna resultado.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>) – Conexión SQLAlchemy activa</p></li>
<li><p><strong>query</strong> (<em>str</em>) – Query SQL con parámetros nombrados (:nombre)</p></li>
<li><p><strong>params</strong> (<em>dict</em><em> | </em><em>None</em>) – Diccionario con parámetros</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resultado de la query (CursorResult)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.utils.db_utils.DatabaseUtils.fetch_all">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fetch_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#DatabaseUtils.fetch_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.DatabaseUtils.fetch_all" title="Link to this definition"></a></dt>
<dd><p>Obtiene todos los resultados.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>) – Conexión activa</p></li>
<li><p><strong>query</strong> (<em>str</em>) – Query SQL</p></li>
<li><p><strong>params</strong> (<em>dict</em><em> | </em><em>None</em>) – Parámetros</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lista de tuplas</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.utils.db_utils.DatabaseUtils.fetch_one">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fetch_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#DatabaseUtils.fetch_one"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.DatabaseUtils.fetch_one" title="Link to this definition"></a></dt>
<dd><p>Obtiene un resultado.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>) – Conexión activa</p></li>
<li><p><strong>query</strong> (<em>str</em>) – Query SQL</p></li>
<li><p><strong>params</strong> (<em>dict</em><em> | </em><em>None</em>) – Parámetros</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Primera fila o None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.utils.db_utils.DatabaseUtils.fetch_scalar">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fetch_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#DatabaseUtils.fetch_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.DatabaseUtils.fetch_scalar" title="Link to this definition"></a></dt>
<dd><p>Obtiene un valor escalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>) – Conexión activa</p></li>
<li><p><strong>query</strong> (<em>str</em>) – Query SQL</p></li>
<li><p><strong>params</strong> (<em>dict</em><em> | </em><em>None</em>) – Parámetros</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Valor escalar o None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any | None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="etl.utils.db_utils.ETLControlQueries">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.utils.db_utils.</span></span><span class="sig-name descname"><span class="pre">ETLControlQueries</span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#ETLControlQueries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.ETLControlQueries" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Queries para tabla de control ETL.</p>
<p>Define sentencias SQL para crear, consultar y actualizar
la tabla de control que rastrea extracciones incrementales.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="etl.utils.db_utils.ETLControlQueries.CREATE_CONTROL_TABLE">
<span class="sig-name descname"><span class="pre">CREATE_CONTROL_TABLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">CREATE</span> <span class="pre">TABLE</span> <span class="pre">IF</span> <span class="pre">NOT</span> <span class="pre">EXISTS</span> <span class="pre">etl_control</span> <span class="pre">(\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">table_name</span> <span class="pre">VARCHAR(255)</span> <span class="pre">PRIMARY</span> <span class="pre">KEY,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">last_extracted_value</span> <span class="pre">VARCHAR(255),\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">last_extracted_at</span> <span class="pre">TIMESTAMP</span> <span class="pre">DEFAULT</span> <span class="pre">CURRENT_TIMESTAMP,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">tracking_column</span> <span class="pre">VARCHAR(255)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)\n</span>&#160;&#160;&#160; <span class="pre">'</span></em><a class="headerlink" href="#etl.utils.db_utils.ETLControlQueries.CREATE_CONTROL_TABLE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etl.utils.db_utils.ETLControlQueries.GET_LAST_VALUE">
<span class="sig-name descname"><span class="pre">GET_LAST_VALUE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">SELECT</span> <span class="pre">last_extracted_value,</span> <span class="pre">tracking_column</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">FROM</span> <span class="pre">etl_control</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">WHERE</span> <span class="pre">table_name</span> <span class="pre">=</span> <span class="pre">:table_name\n</span>&#160;&#160;&#160; <span class="pre">'</span></em><a class="headerlink" href="#etl.utils.db_utils.ETLControlQueries.GET_LAST_VALUE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etl.utils.db_utils.ETLControlQueries.UPSERT_LAST_VALUE">
<span class="sig-name descname"><span class="pre">UPSERT_LAST_VALUE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">INSERT</span> <span class="pre">INTO</span> <span class="pre">etl_control</span> <span class="pre">(table_name,</span> <span class="pre">last_extracted_value,</span> <span class="pre">tracking_column,</span> <span class="pre">last_extracted_at)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">VALUES</span> <span class="pre">(:table_name,</span> <span class="pre">:val,</span> <span class="pre">:col,</span> <span class="pre">CURRENT_TIMESTAMP)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">ON</span> <span class="pre">CONFLICT</span> <span class="pre">(table_name)</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">DO</span> <span class="pre">UPDATE</span> <span class="pre">SET</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">last_extracted_value</span> <span class="pre">=</span> <span class="pre">:val,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">last_extracted_at</span> <span class="pre">=</span> <span class="pre">CURRENT_TIMESTAMP,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">tracking_column</span> <span class="pre">=</span> <span class="pre">:col\n</span>&#160;&#160;&#160; <span class="pre">'</span></em><a class="headerlink" href="#etl.utils.db_utils.ETLControlQueries.UPSERT_LAST_VALUE" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="etl.utils.db_utils.TableQueryBuilder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.utils.db_utils.</span></span><span class="sig-name descname"><span class="pre">TableQueryBuilder</span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#TableQueryBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.TableQueryBuilder" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Constructor de queries para operaciones con tablas.</p>
<p>Proporciona métodos estáticos para construir queries comunes
de inspección de tablas y extracción incremental.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="etl.utils.db_utils.TableQueryBuilder.QUERY_GET_COLUMNS">
<span class="sig-name descname"><span class="pre">QUERY_GET_COLUMNS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">SELECT</span> <span class="pre">column_name,</span> <span class="pre">data_type</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">FROM</span> <span class="pre">information_schema.columns</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">WHERE</span> <span class="pre">table_name</span> <span class="pre">=</span> <span class="pre">:table_name</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AND</span> <span class="pre">table_schema</span> <span class="pre">=</span> <span class="pre">'public'\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">ORDER</span> <span class="pre">BY</span> <span class="pre">ordinal_position\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#etl.utils.db_utils.TableQueryBuilder.QUERY_GET_COLUMNS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etl.utils.db_utils.TableQueryBuilder.QUERY_GET_PRIMARY_KEY">
<span class="sig-name descname"><span class="pre">QUERY_GET_PRIMARY_KEY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">SELECT</span> <span class="pre">ccu.column_name\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">FROM</span> <span class="pre">information_schema.table_constraints</span> <span class="pre">tc</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">JOIN</span> <span class="pre">information_schema.constraint_column_usage</span> <span class="pre">ccu</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">ON</span> <span class="pre">tc.constraint_name</span> <span class="pre">=</span> <span class="pre">ccu.constraint_name</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">WHERE</span> <span class="pre">tc.constraint_type</span> <span class="pre">=</span> <span class="pre">'PRIMARY</span> <span class="pre">KEY'</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AND</span> <span class="pre">tc.table_name</span> <span class="pre">=</span> <span class="pre">:table_name\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">LIMIT</span> <span class="pre">1\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#etl.utils.db_utils.TableQueryBuilder.QUERY_GET_PRIMARY_KEY" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etl.utils.db_utils.TableQueryBuilder.QUERY_LIST_TABLES">
<span class="sig-name descname"><span class="pre">QUERY_LIST_TABLES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">SELECT</span> <span class="pre">table_name</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">FROM</span> <span class="pre">information_schema.tables</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">WHERE</span> <span class="pre">table_schema</span> <span class="pre">=</span> <span class="pre">'public'</span> <span class="pre">\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AND</span> <span class="pre">table_type</span> <span class="pre">=</span> <span class="pre">'BASE</span> <span class="pre">TABLE'\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#etl.utils.db_utils.TableQueryBuilder.QUERY_LIST_TABLES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.utils.db_utils.TableQueryBuilder.get_columns_query">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_columns_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#TableQueryBuilder.get_columns_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.TableQueryBuilder.get_columns_query" title="Link to this definition"></a></dt>
<dd><p>Retorna query y params para obtener columnas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table_name</strong> (<em>str</em>) – Nombre de la tabla</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(query, params_dict)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.utils.db_utils.TableQueryBuilder.get_incremental_extract_query">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_incremental_extract_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracking_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#TableQueryBuilder.get_incremental_extract_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.TableQueryBuilder.get_incremental_extract_query" title="Link to this definition"></a></dt>
<dd><p>Construye query para extracción incremental.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<em>str</em>) – Nombre de la tabla</p></li>
<li><p><strong>tracking_column</strong> (<em>str</em>) – Columna de rastreo (timestamp o id)</p></li>
<li><p><strong>last_value</strong> (<em>Any</em><em> | </em><em>None</em>) – Último valor extraído</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(query_sql, params_dict)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p>Ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">TableQueryBuilder</span><span class="o">.</span><span class="n">get_incremental_extract_query</span><span class="p">(</span>
    <span class="s1">&#39;sensor_readings&#39;</span><span class="p">,</span> <span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;2025-01-01T10:00:00&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.utils.db_utils.TableQueryBuilder.get_list_tables_query">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_list_tables_query</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#TableQueryBuilder.get_list_tables_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.TableQueryBuilder.get_list_tables_query" title="Link to this definition"></a></dt>
<dd><p>Retorna query para listar tablas.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Query SQL para listar todas las tablas en esquema ‘public’</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.utils.db_utils.TableQueryBuilder.get_primary_key_query">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_primary_key_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/etl/utils/db_utils.html#TableQueryBuilder.get_primary_key_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.utils.db_utils.TableQueryBuilder.get_primary_key_query" title="Link to this definition"></a></dt>
<dd><p>Retorna query y params para obtener primary key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table_name</strong> (<em>str</em>) – Nombre de la tabla</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(query, params_dict)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-etl.pipeline">
<span id="orquestacion-pipeline"></span><h2>Orquestación (Pipeline)<a class="headerlink" href="#module-etl.pipeline" title="Link to this heading"></a></h2>
<p>Pipeline principal de ETL que coordina extracción, procesamiento y carga.</p>
<p>El pipeline orquesta las siguientes etapas:
- Inicialización de la tabla de control (etl_control)
- Inspección de tablas disponibles en la base de datos
- Extracción incremental por tabla
- Serialización a archivos temporales y subida a MinIO</p>
<p>El módulo utiliza SQLAlchemy para conexiones y pooling.</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.pipeline.ETLPipeline">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.pipeline.</span></span><span class="sig-name descname"><span class="pre">ETLPipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="config.html#config.database_config.DatabaseConfig" title="config.database_config.DatabaseConfig"><span class="pre">DatabaseConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">minio_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="config.html#config.minio_config.MinIOConfig" title="config.minio_config.MinIOConfig"><span class="pre">MinIOConfig</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/pipeline.html#ETLPipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.pipeline.ETLPipeline" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Pipeline principal que coordina la extracción ETL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_config</strong> (<a class="reference internal" href="config.html#config.database_config.DatabaseConfig" title="config.database_config.DatabaseConfig"><em>DatabaseConfig</em></a>)</p></li>
<li><p><strong>minio_config</strong> (<a class="reference internal" href="config.html#config.minio_config.MinIOConfig" title="config.minio_config.MinIOConfig"><em>MinIOConfig</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="etl.pipeline.ETLPipeline.process_batch">
<span class="sig-name descname"><span class="pre">process_batch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/etl/pipeline.html#ETLPipeline.process_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.pipeline.ETLPipeline.process_batch" title="Link to this definition"></a></dt>
<dd><p>Procesa un batch completo de todas las tablas.</p>
<p>La función abre una conexión (pool), inicializa el gestor de control
y itera por todas las tablas detectadas aplicando el
<a class="reference internal" href="#etl.table_processor.TableProcessor" title="etl.table_processor.TableProcessor"><code class="xref py py-class docutils literal notranslate"><span class="pre">etl.table_processor.TableProcessor</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Total de registros procesados en este batch</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="etl.pipeline.ETLPipeline.run_continuous">
<span class="sig-name descname"><span class="pre">run_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/etl/pipeline.html#ETLPipeline.run_continuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.pipeline.ETLPipeline.run_continuous" title="Link to this definition"></a></dt>
<dd><p>Ejecuta pipeline continuamente.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>interval_seconds</strong> (<em>int</em>) – Segundos entre batches</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-etl.table_processor">Procesamiento de tablas individuales con extracción incremental.</p>
<dl class="py class">
<dt class="sig sig-object py" id="etl.table_processor.TableProcessor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etl.table_processor.</span></span><span class="sig-name descname"><span class="pre">TableProcessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#etl.control.control_manager.ETLControlManager" title="etl.control.control_manager.ETLControlManager"><span class="pre">ETLControlManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">inspector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#etl.extractors.table_inspector.TableInspector" title="etl.extractors.table_inspector.TableInspector"><span class="pre">TableInspector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">minio_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="config.html#config.minio_config.MinIOConfig" title="config.minio_config.MinIOConfig"><span class="pre">MinIOConfig</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/etl/table_processor.html#TableProcessor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.table_processor.TableProcessor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Procesa una tabla individual con extracción incremental.</p>
<p>Se encarga de:
- Detectar columna de rastreo (timestamp o id)
- Extraer nuevos registros usando <code class="xref py py-class docutils literal notranslate"><span class="pre">etl.data_extractor.DataExtractor</span></code>
- Guardar los datos en un archivo temporal y subirlos a MinIO
- Actualizar la tabla de control con el último valor extraído</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> (<em>sqlalchemy.Connection</em>)</p></li>
<li><p><strong>table_name</strong> (<em>str</em>)</p></li>
<li><p><strong>control_manager</strong> (<a class="reference internal" href="#etl.control.control_manager.ETLControlManager" title="etl.control.control_manager.ETLControlManager"><em>ETLControlManager</em></a>)</p></li>
<li><p><strong>inspector</strong> (<a class="reference internal" href="#etl.extractors.table_inspector.TableInspector" title="etl.extractors.table_inspector.TableInspector"><em>TableInspector</em></a>)</p></li>
<li><p><strong>minio_config</strong> (<a class="reference internal" href="config.html#config.minio_config.MinIOConfig" title="config.minio_config.MinIOConfig"><em>MinIOConfig</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="etl.table_processor.TableProcessor.process">
<span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/etl/table_processor.html#TableProcessor.process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etl.table_processor.TableProcessor.process" title="Link to this definition"></a></dt>
<dd><p>Procesa tabla completa con extracción incremental.</p>
<p>Workflow resumido:
1. Detectar columna incremental (ej: created_at o id)
2. Obtener último valor procesado desde etl_control
3. Extraer registros nuevos
4. Si hay datos: escribir a archivo temporal, subir a MinIO y actualizar control</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Cantidad de registros procesados (int)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="Módulos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="config.html" class="btn btn-neutral float-right" title="Config package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>