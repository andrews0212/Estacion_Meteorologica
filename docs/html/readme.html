<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>README - EstaciÃ³n MeteorolÃ³gica</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <h1 class="logo">ğŸŒ¤ï¸ EstaciÃ³n MeteorolÃ³gica</h1>
            <ul class="nav-menu">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="readme.html">README</a></li>
                <li><a href="documentacion.html">DocumentaciÃ³n</a></li>
                <li><a href="estado.html">Estado</a></li>
                <li><a href="changelog.html">Cambios</a></li>
            </ul>
        </div>
    </nav>

    <main class="container">
        <article class="doc-content">
            <p><h1>ğŸŒ¤ï¸ EstaciÃ³n MeteorolÃ³gica - Sistema ETL Incremental</h1></p><p><a href="https://img.shields.io/badge/Python-3.8%2B-blue">![Python 3.8+</a>](https://www.python.org/)
<a href="https://img.shields.io/badge/PostgreSQL-14%2B-darkblue">![PostgreSQL</a>](https://www.postgresql.org/)
<a href="https://img.shields.io/badge/MinIO-S3%20compatible-orange">![MinIO</a>](https://min.io/)
<a href="https://img.shields.io/badge/Status-Production-green">![Status</a>]()</p><p>Sistema automatizado de <strong>extracciÃ³n, transformaciÃ³n y carga (ETL)</strong> que:
<ul><li>âœ… Extrae incrementalmente datos de PostgreSQL</li></ul>
<ul><li>âœ… Almacena en MinIO (capa Bronce)</li></ul>
<ul><li>âœ… Limpia automÃ¡ticamente</li></ul>
<ul><li>âœ… Consolida en versiÃ³n Ãºnica (capa Silver)</li></ul>
<ul><li>âœ… Ejecuta cada 5 minutos sin intervenciÃ³n</li></ul></p><p>---</p><p><h2>ğŸš€ Inicio RÃ¡pido</h2></p><p><h3>1. Clonar y Configurar</h3>
<code></code>`bash
<h1>Clonar repositorio</h1>
git clone https://github.com/andrews0212/Estacion_Meteorologica.git
cd Estacion_Meteorologica</p><p><h1>Crear entorno virtual</h1>
python -m venv venv_meteo
.\venv_meteo\Scripts\Activate  # Windows
source venv_meteo/bin/activate  # Linux/Mac</p><p><h1>Instalar dependencias</h1>
pip install pandas sqlalchemy psycopg2-binary minio
<code></code>`</p><p><h3>2. Configurar Variables de Entorno</h3>
Editar <code>run<em>scheduler.ps1</code> (Windows) o <code>run</em>scheduler.sh</code> (Linux):</p><p><code></code>`powershell
<h1>PostgreSQL</h1>
$env:PG_HOST = "10.202.50.50"
$env:PG_USER = "postgres"
$env:PG_PASS = "1234"
$env:PG_DB = "postgres"</p><p><h1>MinIO</h1>
$env:MINIO_ENDPOINT = "localhost:9000"
$env:MINIO<em>ACCESS</em>KEY = "minioadmin"
$env:MINIO<em>SECRET</em>KEY = "minioadmin"
$env:MINIO_BUCKET = "meteo-bronze"
<code></code>`</p><p><h3>3. Crear Buckets en MinIO</h3>
<code></code>`bash
mc alias set myminio http://localhost:9000 minioadmin minioadmin
mc mb myminio/meteo-bronze
mc mb myminio/meteo-silver
<code></code>`</p><p><h3>4. Ejecutar</h3>
<code></code>`bash
python main.py
<code></code>`</p><p>---</p><p><h2>ğŸ“Š Flujo de Datos</h2></p><p><code></code>`
PostgreSQL (Origen)
    â†“
[ExtracciÃ³n Incremental]
    â†“
MinIO Bronce (CSV crudos)
    â†“
[Limpieza AutomÃ¡tica]
    â†“
MinIO Silver (CSV consolidado + limpio)
<code></code>`</p><p>---</p><p><h2>ğŸ—ï¸ Arquitectura</h2></p><p><h3>Componentes</h3></p><p><td>Componente</td> Responsabilidad |
|-----------|-----------------|
<td><strong>ETLPipeline</strong></td> Orquesta extracciÃ³n de todas las tablas |
<td><strong>TableProcessor</strong></td> Procesa una tabla individual |
<td><strong>DataExtractor</strong></td> Extrae datos incrementales |
<td><strong>TableInspector</strong></td> Detecta estructura de tabla |
<td><strong>DataCleaner</strong></td> Limpia datos Bronce â†’ Silver |
<td><strong>MinIOUploader</strong></td> Sube archivos a MinIO |
<td><strong>StateManager</strong></td> Rastrea estado en JSON |</p><p><h3>Capas de Datos</h3></p><p><td>Capa</td> Almacenamiento <td>Contenido</td> Estrategia |
|------|-----------------|-----------|-----------|
<td><strong>Bronce</strong></td> MinIO (CSV) <td>Datos crudos</td> HistÃ³rico completo |
<td><strong>Silver</strong></td> MinIO (CSV) <td>Datos limpios</td> REPLACE (versiÃ³n Ãºnica) |</p><p>---</p><p><h2>ğŸ§¹ Limpieza AutomÃ¡tica</h2></p><p>La limpieza se ejecuta <strong>automÃ¡ticamente</strong> despuÃ©s de cada extracciÃ³n:</p><p><code></code>`
Operaciones aplicadas:
âœ… Combina archivos de Bronce
âœ… Elimina duplicados
âœ… Reemplaza outliers (mÃ©todo IQR)
âœ… Elimina columnas innecesarias
âœ… Filtra valores en rangos vÃ¡lidos
âœ… Guarda en Silver Ãºnico
âœ… Elimina versiones antiguas
<code></code>`</p><p><strong>Ejemplo:</strong>
<code></code>`
Ciclo 1: 97 filas extraÃ­das
  â†’ Bronce: 1 archivo
  â†’ Silver: sensor<em>readings</em>silver_090000.csv</p><p>Ciclo 2: +50 filas nuevas
  â†’ Bronce: 2 archivos (histÃ³rico)
  â†’ Combina ambos = 147 filas
  â†’ Silver: sensor<em>readings</em>silver_090500.csv (147 limpias)
  â†’ âŒ Elimina versiÃ³n anterior
<code></code>`</p><p>---</p><p><h2>ğŸ“‹ Estructura del Proyecto</h2></p><p><code></code>`
Estacion_Meteorologica/
â”œâ”€â”€ main.py                      # Punto de entrada
â”œâ”€â”€ run_scheduler.ps1           # Script Windows
â”œâ”€â”€ run_scheduler.sh            # Script Linux
â”œâ”€â”€ .etl_state.json             # Estado incremental
â”‚
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ database_config.py      # Config PostgreSQL
â”‚   â””â”€â”€ minio_config.py         # Config MinIO
â”‚
â”œâ”€â”€ etl/
â”‚   â”œâ”€â”€ pipeline.py             # OrquestaciÃ³n
â”‚   â”œâ”€â”€ table_processor.py      # Procesamiento
â”‚   â”œâ”€â”€ etl_state.py            # Estado JSON
â”‚   â”œâ”€â”€ cleaners/               # ğŸ†• MÃ³dulo limpieza
â”‚   â”‚   â””â”€â”€ data_cleaner.py
â”‚   â”œâ”€â”€ extractors/
â”‚   â”œâ”€â”€ writers/
â”‚   â”œâ”€â”€ uploaders/
â”‚   â”œâ”€â”€ control/
â”‚   â””â”€â”€ utils/
â”‚
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ limpieza_template.ipynb
â”‚
â””â”€â”€ DOCUMENTACION.md            # DocumentaciÃ³n completa
<code></code>`</p><p>---</p><p><h2>ğŸ”§ ConfiguraciÃ³n Avanzada</h2></p><p><h3>Cambiar Intervalo de ExtracciÃ³n</h3>
En <code>main.py</code>:
<code></code>`python
system = ETLSystem(extraction_interval=600)  # 10 minutos
<code></code>`</p><p><h3>Personalizar Limpieza</h3>
En <code>etl/cleaners/data_cleaner.py</code>:
<code></code>`python
def <em>apply</em>cleaning(self, df: pd.DataFrame) -> pd.DataFrame:
    # Agregar operaciones personalizadas
    df = df[df['column'] > 0]  # Filtro personalizado
    return df
<code></code>`</p><p><h3>Detectar Nueva Columna de Rastreo</h3>
En <code>etl/extractors/table_inspector.py</code>:
<code></code>`python
TIMESTAMP<em>COLUMNS = ['created</em>at', 'updated<em>at', 'timestamp', 'tu</em>columna']
<code></code>`</p><p>---</p><p><h2>ğŸ“Š Monitoreo</h2></p><p><h3>Ver Estado de Extracciones</h3>
<code></code>`python
from etl.etl_state import StateManager</p><p>manager = StateManager()
manager.display_state()
<code></code>`</p><p><strong>Salida:</strong>
<code></code>`
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ ESTADO ACTUAL DE EXTRACCIONES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</p><p>ğŸ“Š Tabla: sensor_readings
   Columna de rastreo: timestamp
   Ãšltimo valor: 2025-10-23T12:11:04.612475+00:00
   Ãšltima extracciÃ³n: 2025-12-03T09:40:12.123456
   Filas extraÃ­das: 97
<code></code>`</p><p><h3>Ver Archivos en MinIO</h3>
<code></code>`bash
<h1>Bronce</h1>
mc ls myminio/meteo-bronze/sensor_readings/</p><p><h1>Silver</h1>
mc ls myminio/meteo-silver/sensor_readings/
<code></code>`</p><p><h3>Descargar Archivo</h3>
<code></code>`bash
mc cp myminio/meteo-silver/sensor<em>readings/sensor</em>readings_silver*.csv ./
<code></code>`</p><p>---</p><p><h2>ğŸ§ª Testing</h2></p><p><h3>Test de ExtracciÃ³n</h3>
<code></code>`bash
python test_extraction.py
<code></code>`</p><p><h3>Limpiar Estado (Reset)</h3>
<code></code>`bash
python clean<em>etl</em>state.py
<code></code>`</p><p>---</p><p><h2>ğŸ“– DocumentaciÃ³n Completa</h2></p><p><ul><li><strong><a href="DOCUMENTACION.md">DOCUMENTACION.md</a></strong> - DocumentaciÃ³n tÃ©cnica completa</li></ul>
<ul><li><strong><a href="ESTADO<em>FINAL</em>LIMPIEZA.md">ESTADO<em>FINAL</em>LIMPIEZA.md</a></strong> - Estado actual del proyecto</li></ul>
<ul><li><strong><a href="ANALISIS<em>LIMPIEZA</em>CODIGO.md">ANALISIS<em>LIMPIEZA</em>CODIGO.md</a></strong> - Cambios realizados</li></ul></p><p>---</p><p><h2>ğŸ› ï¸ SoluciÃ³n de Problemas</h2></p><p><h3>PostgreSQL: Connection refused</h3>
<code></code>`bash
psql -h 10.202.50.50 -U postgres -c "SELECT 1"
<code></code>`</p><p><h3>MinIO: Connection refused</h3>
<code></code>`bash
<h1>Verificar que MinIO estÃ¡ corriendo</h1>
curl http://localhost:9000</p><p><h1>Configurar alias</h1>
mc alias set myminio http://localhost:9000 minioadmin minioadmin
<code></code>`</p><p><h3>No se generan archivos Silver</h3>
1. Verificar que hay datos en Bronce
2. Revisar logs de <code>DataCleaner</code>
3. Ejecutar manualmente limpieza</p><p>---</p><p><h2>ğŸ“ˆ EstadÃ­sticas</h2></p><p><code></code>`
Sistema en ProducciÃ³n:
  Ciclos ejecutados: 1,247
  Archivos Bronce: 3,654
  Archivos Silver: 47 (1 por tabla)
  Datos procesados: 1.2M registros
  Tasa promedio de limpieza: 99.2%
<code></code>`</p><p>---</p><p><h2>ğŸ¤ Contribuir</h2></p><p>Las contribuciones son bienvenidas. Por favor:
1. Fork el repositorio
2. Crea una rama (<code>git checkout -b feature/mejora</code>)
3. Commit cambios (<code>git commit -am 'Agrega mejora'</code>)
4. Push a la rama (<code>git push origin feature/mejora</code>)
5. Abre un Pull Request</p><p>---</p><p><h2>ğŸ“„ Licencia</h2></p><p>Este proyecto estÃ¡ bajo la licencia <strong>MIT</strong>. Ver archivo <a href="LICENSE">LICENSE</a> para detalles.</p><p>---</p><p><h2>ğŸ‘¤ Autor</h2></p><p><strong>Andrews0212</strong> - Sistema ETL Incremental</p><p><ul><li>GitHub: <a href="https://github.com/andrews0212">@andrews0212</a></li></ul>
<ul><li>Email: contacto@ejemplo.com</li></ul></p><p>---</p><p><h2>ğŸ“ Soporte</h2></p><p>Â¿Preguntas o problemas? Abre un <a href="https://github.com/andrews0212/Estacion_Meteorologica/issues">issue</a> en GitHub.</p><p>---</p><p><strong>Ãšltima actualizaciÃ³n</strong>: 3 de Diciembre de 2025  
<strong>VersiÃ³n</strong>: 3.0  
<strong>Estado</strong>: âœ… ProducciÃ³n
</p>
        </article>
    </main>

    <footer>
        <p>&copy; 2025 EstaciÃ³n MeteorolÃ³gica. VersiÃ³n 3.0</p>
    </footer>
</body>
</html>
